<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">

	<head>
		<title>FinderSelection Reference</title>
		<meta name="AppleTitle" content="FinderSelection Reference" />

		<meta http-equiv="content-type" content="text/html;charset=utf-8" />
		<link href="assets/default.css" type="text/css" rel="stylesheet" media="all" />
        <link href="assets/applescript.css" type="text/css" rel="stylesheet" media="all" />
		<meta name="keywords" content="FinderSelection, AppleScript" />
		<script type="text/javascript" src="assets-helpbook/run_helpscript.js"></script>
		<script type="text/javascript" src="assets/navibar-jump.js"></script>
        <link id="helpviewer-handler-helper" href="assets-helpbook/helpviewer-handler-helper.scpt" />
        <script type="text/javascript" src="assets-helpbook/helpviewer-handler-enable.js"></script>
        <link href="./" id="HelpBookRoot" />
	</head>

	<body>
		<div id="navi-bar">
			<div class="edit-script-link">
				<a onclick="return runHelpScriptWithBundleRoot(this)" href="assets-helpbook/editScript.scpt">Edit Script</a>
			</div>
			<div class="left-contents">
			<div class="to-root">
				<!-- InstanceBeginEditable name="to-root" --><!-- InstanceEndEditable -->
			</div>
			<select onchange="navibarJump(this)">
<option value="">
§
</option>
<option value="#Constructors">
Constructors
</option>
<option value="#make_for_item">
- make_for_item
</option>
<option value="#make_for_file">
- make_for_file
</option>
<option value="#make_for_document">
- make_for_document
</option>
<option value="#make_for_application">
- make_for_application
</option>
<option value="#make_for_package">
- make_for_package
</option>
<option value="#make_for_container">
- make_for_container
</option>
<option value="#make_for_folder">
- make_for_folder
</option>
<option value="#make_for_disk">
- make_for_disk
</option>
<option value="#Getting_Finder's_Selection">
Getting Finder's Selection 
</option>
<option value="#get_selection">
- get_selection
</option>
<option value="#is_insertion_location">
- is_insertion_location
</option>
<option value="#Accessor_Methods">
Accessor Methods 
</option>
<option value="#set_types">
- set_types
</option>
<option value="#set_extensions">
- set_extensions
</option>
<option value="#set_prompt_message">
- set_prompt_message
</option>
<option value="#set_use_chooser">
- set_use_chooser
</option>
<option value="#set_use_insertion_location">
- set_use_insertion_location
</option>
<option value="#set_allow_myself">
- set_allow_myself
</option>
<option value="#set_resolve_alias">
- set_resolve_alias
</option>
<option value="#set_default_location">
- set_default_location
</option>
<option value="#Setup_Kind_Items_to_Pick_Up">
Setup Kind Items to Pick Up 
</option>
<option value="#setup_for_item">
- setup_for_item
</option>
<option value="#setup_for_file">
- setup_for_file
</option>
<option value="#setup_for_document">
- setup_for_document
</option>
<option value="#setup_for_application">
- setup_for_application
</option>
<option value="#setup_for_package">
- setup_for_package
</option>
<option value="#setup_for_container">
- setup_for_container
</option>
<option value="#setup_for_folder">
- setup_for_folder
</option>
<option value="#setup_for_disk">
- setup_for_disk
</option>
<option value="#Utility_Handlers">
Utility Handlers
</option>
<option value="#is_same_to_me">
- is_same_to_me
</option>
</select>
			</div>
		</div>
		<!-- InstanceBeginEditable name="prev-next-item" --><!-- InstanceEndEditable -->
		<div id="contents">
		<h1>FinderSelection Reference</h1>
<ul>
<li>Version : 2.1</li>
<li>Author : Tetsuro KURITA <a href="mailto:scriptfactory@mac.com">scriptfactory@mac.com</a></li>
<li>Requirements : OS X 10.9 or later</li>
<li><a href="http://www.script-factory.net/XModules/FiderSelection/index.html">Home page</a> || <a href="http://www.script-factory.net/XModules/FinderSelection/changelog.html">ChangeLog</a> || <a href="https://github.com/tkurita/FinderSelection.scptd">Repository</a> </li>
</ul>
<p>Finder の選択項目を取得する AppleScript ライブラリです。以下のような処理を簡便に行えます。</p>
<ul>
<li>Finder の選択物の中から必要なもの（種類、ファイルタイプ、拡張子 で指定）だけを選び出します。</li>
<li>選択物がなかったり条件に該当するものがなかったら、ファイル選択ダイアログを開きます。</li>
<li>Droplet/Applet が Finder からダブルクリックによって起動されたら、ファイル選択ダイアログ を開きます。</li>
<li>選択物中にエイリアスファイルが含まれていたら、オリジナルへの参照を取得してオリジナルが条件に該当するか調べます。
<ul>
<li>エイリアスファイルのオリジナルを求めない動作を設定する事もできます。</li>
</ul>
</li>
</ul>
<p>処理の流れは次のようになります。</p>
<ol>
<li><a href="#Constructors">Constructor</a> Method によって、FinderSelection のインスタンスを生成する。どの <a href="#Constructors">Constructor</a> を使うかによって、取得するファイル/フォルダの種類が決まる。</li>
<li><a href="pages/set_prompt_message.html">set_prompt_message</a> を使ってファイル/フォルダ選択ダイアログのメッセージを設定する。
<ul>
<li>ファイル/フォルダ選択ダイアログは条件にあった選択物が無い場合に開かれます。</li>
</ul>
</li>
<li>必要があれば、<a href="pages/set_types.html">set_types</a>, <a href="pages/set_extensions.html">set_extensions</a> によって、URI、ファイルタイプ、拡張子の条件を設定する。
<ul>
<li><a href="pages/set_types.html">set_types</a>, と <a href="pages/set_extensions.html">set_extensions</a> を同時に設定した場合、どちらかの条件に一致したら目的のファイルと見なします。</li>
</ul>
</li>
<li><a href="pages/get_selection.html">get_selection</a> によって、条件にあった、Finder の選択物を取得する。</li>
</ol>
<p>テキストファイルと PDF ファイルを取得する例を示します。</p>
<div class="sourceCode">
<div class="scriptButton">
    <input type="button" value="Open this script" onclick="document.location = this.src" src="applescript://com.apple.scripteditor?action=new&amp;script=use%20FinderSelection%20:%20script%20%22FinderSelection%22%0D%0Dset%20file_picker%20to%20FinderSelection%27s%20make_for_file()%0D%0Dtell%20file_picker%0D%09set_prompt_message(%22Choose%20text%20file%20or%20PDF%20file.%22)%0D%09set_types(%7B%22com.apple.traditional-mac-plain-text%22,%20%22TEXT%22,%20%22PDF%20%22%7D)%0D%09set_extensions(%7B%22.txt%22,%20%22.pdf%22%7D)%0D%09get_selection()%0Dend%20tell%0D%20" />
</div><div>
<span class="langKeyword">use</span> <span class="userDefine">FinderSelection</span><span class="normal"> : </span><span class="className">script</span><span class="normal"> &quot;FinderSelection&quot;</span>
</div>
<br />
<div>
<span class="langKeyword">set</span> <span class="userDefine">file_picker</span> <span class="langKeyword">to</span> <span class="userDefine">FinderSelection's</span> <span class="userDefine">make_for_file</span><span class="normal">()</span>
</div>
<br />
<div>
<span class="langKeyword">tell</span> <span class="userDefine">file_picker</span>
</div>
<div style="text-indent:4ex;">
<span class="userDefine">set_prompt_message</span><span class="normal">(&quot;Choose text file or PDF file.&quot;)</span>
</div>
<div style="text-indent:4ex;">
<span class="userDefine">set_types</span><span class="normal">({&quot;com.apple.traditional-mac-plain-text&quot;, &quot;TEXT&quot;, &quot;PDF &quot;})</span>
</div>
<div style="text-indent:4ex;">
<span class="userDefine">set_extensions</span><span class="normal">({&quot;.txt&quot;, &quot;.pdf&quot;})</span>
</div>
<div style="text-indent:4ex;">
<span class="userDefine">get_selection</span><span class="normal">()</span>
</div>
<div>
<span class="langKeyword">end</span> <span class="langKeyword">tell</span>
</div>
</div>
<h2 id="Constructors">Constructors</h2>
<p>Finder から取得したいファイル/フォルダの種類に応じたインスタンスを生成します。</p>
<h3 id="make_for_item"><a href="pages/make_for_item.html">make_for_item</a></h3>
<p>Finder で選択されているファイル/フォルダをすべて取得するオブジェクトを生成します。</p>
<h3 id="make_for_file"><a href="pages/make_for_file.html">make_for_file</a></h3>
<p>選択されているものの中から、ファイルを取得するオブジェクトを生成します。</p>
<h3 id="make_for_document"><a href="pages/make_for_document.html">make_for_document</a></h3>
<p>選択されているものの中から、書類ファイルを取得するオブジェクトを生成します。</p>
<h3 id="make_for_application"><a href="pages/make_for_application.html">make_for_application</a></h3>
<p>選択されているものの中から、アプリケーションを取得するオブジェクトを生成します。</p>
<h3 id="make_for_package"><a href="pages/make_for_package.html">make_for_package</a></h3>
<p>選択されているものの中から、パッケージを取得するオブジェクトを生成します。</p>
<h3 id="make_for_container"><a href="pages/make_for_container.html">make_for_container</a></h3>
<p>選択されているものの中から、ディスクもしくはフォルダを取得するオブジェクトを生成します。</p>
<h3 id="make_for_folder"><a href="pages/make_for_folder.html">make_for_folder</a></h3>
<p>選択されているものの中から、フォルダを取得するオブジェクトを生成します。</p>
<h3 id="make_for_disk"><a href="pages/make_for_disk.html">make_for_disk</a></h3>
<p>選択されているものの中から、ディスクを取得するオブジェクトを生成します。</p>
<h2 id="Getting_Finder's_Selection">Getting Finder's Selection </h2>
<h3 id="get_selection"><a href="pages/get_selection.html">get_selection</a></h3>
<p>Finder で選択されている項目を取得します。</p>
<h3 id="is_insertion_location"><a href="pages/is_insertion_location.html">is_insertion_location</a></h3>
<p>Return whether an item returned by <a href="pages/get_selection.html">get_selection</a> is Finder's insertion location or not.</p>
<h2 id="Accessor_Methods">Accessor Methods </h2>
<p>FinderSelection のインスタンスの動作をカスタマイズします。よく使う method は次の ３つだと思います。</p>
<ul>
<li><a href="pages/set_types.html">set_types</a></li>
<li><a href="pages/set_extensions.html">set_extensions</a></li>
<li><a href="pages/set_prompt_message.html">set_prompt_message</a></li>
</ul>
<h3 id="set_types"><a href="pages/set_types.html">set_types</a></h3>
<p>取得したいファイルの UTI もしくはファイルタイプを設定します。</p>
<h3 id="set_extensions"><a href="pages/set_extensions.html">set_extensions</a></h3>
<p>取得したいファイル/フォルダの拡張子を設定します。</p>
<h3 id="set_prompt_message"><a href="pages/set_prompt_message.html">set_prompt_message</a></h3>
<p>ファイル/フォルダ選択ダイアログで表示されるメッセージ</p>
<h3 id="set_use_chooser"><a href="pages/set_use_chooser.html">set_use_chooser</a></h3>
<p>Finder で選択項目が無い場合、 ファイル/フォルダ選択ダイアログを開くかどうか。</p>
<h3 id="set_use_insertion_location"><a href="pages/set_use_insertion_location.html">set_use_insertion_location</a></h3>
<p>Finder で選択項目が無い場合、 選択されている場所を取得するかどうか。</p>
<h3 id="set_allow_myself"><a href="pages/set_allow_myself.html">set_allow_myself</a></h3>
<p>Finder で自分自身（スクリプトファイルやアプリケーション）が選択されている場合、選択項目に含めるかどうか。</p>
<h3 id="set_resolve_alias"><a href="pages/set_resolve_alias.html">set_resolve_alias</a></h3>
<p>エイリアスファイルが Finder で選択されている時に、そのオリジナルを求めるかどうか</p>
<h3 id="set_default_location"><a href="pages/set_default_location.html">set_default_location</a></h3>
<p>Finder で選択項目が無い場合に開かれるファイル/フォルダ選択ダイアログの最初の場所</p>
<h2 id="Setup_Kind_Items_to_Pick_Up">Setup Kind Items to Pick Up </h2>
<p>取得するファイル/フォルダの種類を設定します。Constructor　の中で実行されるので、通常は使う必要がないはずです。インスタンスを生成後、取得する項目の種類を変えたいときに使えます。</p>
<h3 id="setup_for_item"><a href="pages/setup_for_item.html">setup_for_item</a></h3>
<p>すべてのファイル/フォルダを対象とします。</p>
<h3 id="setup_for_file"><a href="pages/setup_for_file.html">setup_for_file</a></h3>
<p>取得する項目をファイルだけに制限します。</p>
<h3 id="setup_for_document"><a href="pages/setup_for_document.html">setup_for_document</a></h3>
<p>取得する項目を書類ファイルだけに制限します。</p>
<h3 id="setup_for_application"><a href="pages/setup_for_application.html">setup_for_application</a></h3>
<p>取得する項目をアプリケーションファイルだけに制限します。</p>
<h3 id="setup_for_package"><a href="pages/setup_for_package.html">setup_for_package</a></h3>
<p>取得する項目をパッケージだけに制限します。</p>
<h3 id="setup_for_container"><a href="pages/setup_for_container.html">setup_for_container</a></h3>
<p>取得する項目をコンテナ（フォルダもしくはディスク）だけに制限します。</p>
<h3 id="setup_for_folder"><a href="pages/setup_for_folder.html">setup_for_folder</a></h3>
<p>取得する項目をフォルダだけに制限します。</p>
<h3 id="setup_for_disk"><a href="pages/setup_for_disk.html">setup_for_disk</a></h3>
<p>取得する項目をディスクだけに制限します。</p>
<h2 id="Utility_Handlers">Utility Handlers</h2>
<h3 id="is_same_to_me"><a href="pages/is_same_to_me.html">is_same_to_me</a></h3>
<p>ファイルが path to me もしくは path to current application で得られる項目と同じ物がどうか調べます。</p>
		</div>
		<!-- InstanceBeginEditable name="prev-next-item" --><!-- InstanceEndEditable -->
	</body>

</html>